{% extends "layout.html" %}
{% block title %}Centros de Ayuda{% endblock %}
{% block head %}
  {{ super() }}
{% endblock %}
{% block content %}
<div id="derecha">
  <a href="{{ url_for('centro_index', page=1) }}" class="btn btn-primary">Volver</a>
</div>
  <div id="show">
  <strong class="texto" style="font-size: x-large;">INFORMACIÓN DEL CENTRO:</strong><br><br>
    
  {#-----------------------   DATOS DEL CENTRO   ----------------------------#}
  <div style="float: left;">
    
      <strong class="texto-show">Nombre: </strong>
      <strong class="text-text"> {{ centro.nombre }}</strong><br>

      <strong class="texto-show">Tipo de Centro: </strong>
      <strong class="text-text"> {{ centro.tipo_centro }} </strong><br>

      <strong class="texto-show">Direccion: </strong>
      <strong class="text-text"> {{ centro.direccion }} </strong><br>
    
      <strong class="texto-show">Municipio: </strong>
      <strong class="text-text"> {{ centro.municipio }} </strong><br>
    
      <strong class="texto-show">Email: </strong>
      <strong class="text-text"> {{ centro.email }} </strong><br>
    
      <strong class="texto-show">Estado: </strong>
      <strong class="text-text"> {{ centro.estado }} </strong><br>

      <strong class="texto-show">Protocolo: </strong>
      {% if centro.protocolo != 'NULL' %}
      <strong class="text-text"> {{ centro.protocolo }} </strong><br>
      {% else %}
      <strong class="text-text"> sin protocolo </strong><br>
      {% endif %}
  </div>
    <div>
    <strong class="texto-show" style="padding-left: 20px; padding-right: 20px;">Ubicacion: </strong>
    <input type="hidden" value="{{centro.latitud}}" id="latitud" >
    <input type="hidden" value="{{centro.longitud}}" id="longitud" >
        
    <div id="myMap" style="height: 180px;">
      <script src="{{ url_for('static', filename='mapaShow.js') }}"></script> 
    </div> 
    </div>
{#-----------------------------------------------#}
  <br>
  <a href="{{url_for('turnos_new', centro_id=centro.id)}}" class="btn btn-primary">Solicitar turno</a>
  <br>

  {#-------------busqueda de turnos--------------#}

  <div id="formBusqueda">
    <strong class="texto" style="font-size: medium;">Busqueda de turnos:</strong>
    <br>
    <form action="{{url_for('centro_show')}}" method="GET" class="form-inline my-1">

      <div class="busqueda">
        <strong>Email de solicitante:</strong><br>
        <select name="email" class="form-control mr-sm-1">
          {% if search["email"] and search["email"] != "todos" %}
          <option value="{{ search['email'] }}">{{ search["email"] }}</option>
          {% endif%}
          <option value="todos">TODOS</option>
          {% for email in emails %}
            <option value="{{ email }}">{{ email }}</option>
          {% endfor %}  
          
        </select>
      </div>
      <div style="margin-left: 40px;">
        <input type="hidden" name="centro_id" value="{{ centro.id }}">
        <input type="submit"  class="btn btn-primary" value="Buscar">
        <a href="#" class="btn btn-secundary" >Limpiar búsqueda</a>
      </div>
    </form>
  </div>

  {#---------------------------  Index de Turnos  ----------------------------#}

  <strong class="texto-show">Listado de turnos solicitados: </strong>
  {% if not index_pag.items %}
  <strong style="color: red; margin-left:70px "> No se encontraron turnos para el email ingresado</strong>
  {% else %}
  <table class="table table-hover">
    <tr>
      <td>
        <strong class="=texto-text">Día:</strong>
      </td>
      <td>
        <strong class="texto-text">Horario:</strong>
      </td>
      <td>
        <strong class="texto-text">Email solicitante:</strong>
      </td>
      <td></td>
    </tr>
    {% for turno in index_pag.items %}
    <tr>
      <td>
        <strong class="text-text"> {{ turno.dia }} </strong>
      </td>
      <td>
        <strong class="text-text"> {{ turno.bloque.hora_inicio }}hs - {{ turno.bloque.hora_fin }}hs </strong>
      </td>
      <td>
        <strong class="text-text"> {{ turno.email }} </strong>
      </td>
      <td>
        {% if turno.estado=="VIGENTE" %}
        <a href="{{ url_for('turnos_eliminar', turno_id=turno.id, centro_id=centro.id, page=index_pag.page, email=search['email'])}}" 
          onclick="return confirmationTurno()" class="btn btn-danger">Cancelar</a>
        <script src="{{ url_for('static', filename='validaciones/turnos.js') }}"></script>
        {% else %}
        <strong class="text-text" style="color: red;"> {{ turno.estado }} </strong>
        {% endif %}
      </td>
    </tr>  
    {% endfor %}
  </table>
  {% endif %}

  {#-----------------------------PAGINADO------------------------------------#}
    <nav aria-label="..." style="margin-left:15%;" >
      <ul class="pagination" style="margin-left: 35%;">   
      {% for page in index_pag.iter_pages() %}
        {% if page %}
          {% if page != index_pag.page %}
            <li class="page-item">
              <a class="page-link" href="{{url_for('centro_show',centro_id=centro.id, page=page, email=search['email'])}}">{{ page }}</a>
            </li>
          {% else %}
            <li class="page-item active">
              <span class="page-link">
              {{ page }}
              <span class="sr-only">(current)</span>
              </span>
            </li>
          {% endif %}
        {% else %}
          <span class=ellipsis> . . . </span>
        {% endif %}
      {% endfor %}
      </ul>
    </nav>
    {#----------------------------------------------------------------------#}
  
</div>
  
{% endblock %}